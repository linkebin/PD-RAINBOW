<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en"  xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>个人信息</title>
    <link rel="stylesheet" th:href="@{/Styles/themes/mycss/amazeui.cropper.css}">
    <link rel="stylesheet" th:href="@{/Styles/themes/mycss/amazeui.min.css}">
    <link rel="stylesheet" th:href="@{/Styles/themes/mycss/custom_up_img.css}">
    <link rel="stylesheet" th:href="@{/Styles/themes/default/style.css}" media="all">
    <style>
        .defaultDiv{width: 100%; border: 1px solid ghostwhite;}
        .formDiv .eui-form-item label{
            width: 120px;
            padding: 9px 20px;
            text-align: left;
        }
        .subBtn{color: white; background: #3f89ec;}

        input[type="button"],[type="submit"]{
            cursor: pointer;
        }
        input[name='userName'],[name='addr']{
            border: 1px solid #1aa194;
        }
    </style>
</head>
<body class="eui-layout-body">
<div class="eui-layout eui-layout-admin xymfHome">
    <div th:replace="project/cube/common/header :: header(${7})">Header</div>
    <div class="eui-area">
        <div th:replace="project/cube/common/left :: left(${-1})">sidebar</div>
        <div class="eui-body">
            <!-- 内容主体区域 -->
            <div class="xymfContent">
                <div class="defaultDiv">

                        <div class="eui-padding20">
                            <h1 style="display: inline; font-size: 20px;">基本资料</h1>
                        </div>

                    <form style="width: 65%;float: left;" id="userInfoForm" class="eui-padding20" onsubmit="return false;">
                        <input type="hidden" th:value="${session.userSession.headImg}" name="headImg">
                        <div class="formDiv">
                            <input type="hidden" id="id" name="id" th:value="${session.userSession.id}">
                            <div class="eui-form-item">
                                <label class="eui-form-label">账号</label>
                                <div class="eui-input-inline">
                                    <input type="text" name="account" th:value="${session.userSession.account}" readonly="readonly" class="eui-input eui-width400">
                                </div>
                            </div>

                            <div class="eui-form-item">
                                <label class="eui-form-label">用户名</label>
                                <div class="eui-input-inline eui-width400">
                                    <input type="text" name="userName" th:value="${session.userSession.userName}"  class="eui-input eui-width400">
                                </div>
                                <div class="eui-form-mid eui-word-aux"><a id="error0" style="color: red;"></a></div>
                            </div>


                            <div class="eui-form-item">
                                <label class="eui-form-label">手机号</label>
                                <div class="eui-input-inline eui-width400">
                                    <input type="text" name="mobile" th:value="${session.userSession.mobile}" readonly="readonly"  class="eui-input eui-width400">
                                </div>
                                <div class="eui-form-mid eui-word-aux"><a>更改</a></div>
                            </div>

                            <div class="eui-form-item">
                                <label class="eui-form-label">邮箱</label>
                                <div class="eui-input-inline eui-width400">
                                    <input type="text" th:value="${session.userSession.email}" name="email" readonly="readonly"  class="eui-input eui-width400">
                                </div>
                                <div class="eui-form-mid eui-word-aux"><a>更改</a></div>
                            </div>

                            <div class="eui-form-item">
                                <label class="eui-form-label">推广码</label>
                                <div class="eui-input-inline">
                                    <input th:value="${session.userSession.inviterCode}" type="text" name="inviterCode" readonly="readonly"  class="eui-input eui-width400">
                                </div>
                                <div class="eui-form-mid eui-word-aux"></div>
                            </div>

                            <div  data-toggle="distpicker">
                            <div class="eui-form-item">
                                <label class="eui-form-label">省</label>
                                <div class="eui-input-inline">
                                    <select data-province="" id="province" class="eui-input eui-width400" e-ignore name="province">
                                    </select>
                                </div>
                                <div class="eui-form-mid eui-word-aux"></div>
                            </div>
                            <div class="eui-form-item">
                                <label class="eui-form-label">市</label>
                                <div class="eui-input-inline">
                                    <select data-province="" id="city" class="eui-input eui-width400" e-ignore name="city">
                                    </select>

                                </div>
                                <div class="eui-form-mid eui-word-aux"></div>
                            </div>
                            <div class="eui-form-item">
                                <label class="eui-form-label">区</label>
                                <div class="eui-input-inline">
                                    <select data-province="" id="district" class="eui-input eui-width400" e-ignore name="district">
                                    </select>

                                </div>
                                <div class="eui-form-mid eui-word-aux"></div>
                            </div>
                            </div>


                            <div class="eui-form-item">
                                <label class="eui-form-label">详细地址</label>
                                <div class="eui-input-inline">
                                    <input th:value="${session.userSession.addr}" type="text" name="addr"   class="eui-input eui-width400">
                                </div>
                                <div class="eui-form-mid eui-word-aux"></div>
                            </div>

                            <div class="eui-form-item">
                                <label class="eui-form-label"></label>
                                <div class="eui-input-inline">
                                    <button   type="submit"   class="eui-btn eui-btn-small eui-btn-normal">
                                        保存修改
                                    </button>
                                </div>
                                <div class="eui-input-inline">
                                    <a id="errcode0"></a>
                                </div>

                            </div>
                        </div>
                    </form>

                    <div style="width: 33%;float: right;" class="eui-paddingT20">
                        <button   type="button"   class="eui-btn eui-btn-small eui-btn-normal" id="upFiles">
                            <i class="eui-icon">&#xe67c;</i>上传图片
                        </button><br/>
                        <span style="font-size: 12px;">(只支持图片上传,支持jpg,png)</span>
                    </div>

                    <div style="width: 33%;float: right;" class="">
                        <div style="width: 100px; height: 100px; float: left;">
                            <img id="headImg" th:src="${'/files'+session.userSession.headImg+'?t='+'javascript:Math.random()'}" width="90" height="90">
                        </div>
                    </div>
                </div>
            </div>


            <!--图片上传框-->
            <div  class="am-modal am-modal-no-btn up-frame-bj " tabindex="-1" id="doc-modal-1">
                <div class="am-modal-dialog up-frame-parent up-frame-radius">
                    <div class="am-modal-hd up-frame-header">
                        <label style="color: #1E9FFF">上传图片</label>
                        <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
                    </div>
                    <div class="am-modal-bd  up-frame-body">
                        <div class="am-g am-fl">
                            <div class="am-form-group am-form-file">
                                <div class="am-fl">
                                    <button type="button" class="eui-btn eui-btn-small eui-btn-normal">
                                        <i class="eui-icon">&#xe67c;</i> 选择要上传的图片</button>
                                </div>
                                <input type="file" id="inputImage">
                            </div>
                        </div>
                        <div class="am-g am-fl" >
                            <div class="up-pre-before up-frame-radius">
                                <img alt="" src="" id="image" >
                            </div>
                            <div class="up-pre-after up-frame-radius">
                            </div>
                        </div>
                        <div class="am-g am-fl">
                            <div  style="background: center;" class="up-control-btns">
                                <a  class="eui-btn eui-btn-small  eui-btn-normal" id="up-btn-ok" url="/upload/upload/cropHeadImg">保存修改</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>


        </div>
    </div>
    <div th:replace="project/cube/common/footer :: footer">footer</div>

</div>
<script type="text/javascript" src="/Scripts/jquery-1.9.0.min.js"></script>
<script src="/Scripts/module/eui.js" charset="utf-8"></script>
<script src="/Scripts/main.js" charset="utf-8"></script>



<script src="/Scripts/libs/ligerUI/js/ligerui.all.js" type="text/javascript"></script>
<script src="/pack.ajax.js" type="text/javascript"></script>
<script src="/Scripts/date2format.js" type="text/javascript"></script>
<script src="/Scripts/plugins/jquery.validate.js"></script>
<script src="/Scripts/plugins/amazeui.min.js"></script>
<script src="/Scripts/plugins/cropper.min.js"></script>
<script src="/Scripts/plugins/custom_up_img.js"></script>
<script type="text/javascript" th:src="@{/Scripts/cube/header.js}"></script>
<script src="/Scripts/plugins/distpicker.data.js"></script>
<script src="/Scripts/plugins/distpicker.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    var updateObj  =[[${session.userSession}]];
    /*]]>*/



</script>

<script>
    // 表单
    eui.use(['form', 'layedit', 'laydate', 'laypage', 'layer'], function () {
        var form = eui.form
            , layer = eui.layer
            , layedit = eui.layedit
            , laydate = eui.laydate
            , laypage = eui.laypage;

        $('#province').val(updateObj .province);
        $('#province').trigger("change");

        $('#city').val(updateObj .city);
        $('#city').trigger("change");

        $('#district').val(updateObj .district);
        $('#district').trigger("change");
    });

    $(function () {
        $("#userInfoForm").validate({
            submitHandler: function() {
                $("#error0").html('');
                if ($("#userInfoForm input[name='userName']").val()!=''){
                    var obj = $("#userInfoForm").serializeObject();
                    $.post('/user/userUpdate',{json:JSON.stringify(obj)},function (result) {
                        if (result.code ==200){
                            $("#userName").html(obj.userName)
                        }
                        layer.msg(result.message);
                    });
                }else {
                    layer.msg('用户名不能为空')
                }

            }
        });
    });
</script>
</body>
</html>